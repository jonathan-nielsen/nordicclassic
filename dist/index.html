<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Welcome to Nordic Classic!</title>
		<link rel="stylesheet" href="./css/viewport.css">
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145851938-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-145851938-1');
		</script>
	</head>
	<body>
		<div class="hero">
			<div class="bg"></div>
			<div class="title centered welcome px-3">Welcome to the Nordic Gehennas Community</div>
		</div>
		<div class="container news">
			<div class="row">
				<div class="col-12 col-md-10 offset-md-1">
					<div class="title">News</div>
					<div class="updates py-3 py-md-5">
						<div class="update">
							<time datetime="2019-08-20 - 21:30">2019-08-20 - 21:30</time>
							<p>Quick update the Nordic Gehennas community is staying.
								<br>A large section of the Finnish community has recently decided to join us here at Gehennas
								<br>Any nordic player that is interested in joining this great community please check the links below!
								<br>Less than a week left until we all are playing classic!</p>
						</div>
						<div class="update">
							<time datetime="2019-08-17 - 19:05">2019-08-17 - 19:05</time>
							<p>Today the site has had over 20000 downloads and we are seeing many new nordic guilds join our new home.
								<br>All guilds in the Nordic Coalition welcomes the new guilds and all their players. Many guilds that decided
								<br>to stay on Shazzra are now joining the nordic coalition once again. We are very happy to see you all here again.</p>
						</div>
						<div class="update">
							<time datetime="2019-08-17 - 11:50">2019-08-17 - 11:50</time>
							<p>We have launched a new Discord server for our Nordic Community on Gehennas: <a href="https://discord.gg/cy45Gqa" target="_blank">discord.gg/cy45Gqa</a></p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="container links mt-3 mt-md-5">
			<div class="row">
				<div class="col-12 col-md-10 offset-md-1">
					<div class="title">Links</div>
					<div class="py-3 py-md-5">
						<ul class="list-unstyled">
							<li>Gehennas Nordic Community Discord: <a href="https://discord.gg/cy45Gqa" target="_blank">discord.gg/cy45Gqa</a></li>
							<li>Gehennas Main Community Discord: <a href="https://discord.gg/x6ueZeA" target="_blank">discord.gg/x6ueZeA</a></li>
							<li>Spreadsheet over Nordic guilds chosen to play on Gehennas: <a href="https://docs.google.com/spreadsheets/d/1AbFd4B3008AEpfAoASFTUp3oUq2sw3rs4IoeoR8-X5c/edit#gid=0" target="_blank">Nordic Guilds</a></li>
							<li>Judgement's Alliance leveling guide: <a href="https://docs.google.com/document/d/18H0AWJMvQSIrFdZMTRYcYZcWBsjCPZmy9eHygEWMsKU/preview" target="_blank">Alliance leveling guide</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="container mt-4 py-3 py-md-5">
			<div class="row">
				<div class="col-3 col-md-12 text-md-center px-0 px-md-3 horde-alliance mb-5 mb-md-0">
					<img src="./img/horde-alliance.png" alt="">
				</div>
				<h3 class="col-9 col-md-12 py-4 py-md-0 pl-0 pl-md-3 text-md-center mb-4 mb-md-5 supporting">
					The following WoW Classic guilds
					<br>has chosen to support this initiative.
				</h3>
				<div class="col-12 col-md-6">
					<div class="title mb-5">Horde</div>
					<div class="row" id="horde-guilds"></div>
				</div>
				<div class="col-12 col-md-6 text-md-right mt-5 mt-md-0">
					<div class="text-md-right md-right title mb-5">Alliance</div>
					<div class="row" id="alliance-guilds"></div>
				</div>
			</div>
			<div class="row mx-0">
				<div class="d-inline-block position-relative" style="left: 50%; transform: translateX(-150px);">
					<div id="piechart" style="width: 300px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="join-us mt-5 py-4 py-md-5">
			<div class="container">
				<div class="row">
					<div class="title">Join us</div>
					<p class="col-12">Do your guild wish to become a part of Nordic Classic?
						<br>Please contact the Guild Masters of either <b>BIZZNO</b> or <b>SCRUBCLUB</b>.
						<br>You'll find a link to their Discord server amongst the listed guilds.</p>
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="copyright col-12 text-center py-4 py-md-5">
					Copyright Â® 2019 Nordic Classic
					<br>Design by the Nordic Classic Community
				</div>
			</div>
		</div>
		<link rel="stylesheet" href="./css/bootstrap/bootstrap.min.css">
		<link rel="stylesheet" href="./css/style.css?v=2">
		<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
		<script src="https://apis.google.com/js/api.js"></script>
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<script type="text/javascript">
		function loadPlayersChart(players) {
			google.charts.load('current', {'packages':['corechart']});
			google.charts.setOnLoadCallback(drawChart);

			function drawChart() {

				console.log(players)

				var data = google.visualization.arrayToDataTable([
					['Faction', 'Players'],
					['Alliance', players.alliance],
					['Horde', players.horde],
				]);

				var options = {
					backgroundColor: {
						fill: 'black',
						stroke: '#000',
					},
					pieSliceBorderColor: 'black',
					legend: 'none',
					slices: {
						0: { color: '#04528f' },
						1: { color: '#771319' },
					}
				};

				var chart = new google.visualization.PieChart(document.getElementById('piechart'));

				chart.draw(data, options);
			}
		}
		</script>
		<script>
		function start() {
			gapi.client.init({
				'apiKey': 'AIzaSyCLd8pNZypoOYdG2rHcKuYKgHveQlxj9TE',
				'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
			}).then(function() {
				return gapi.client.sheets.spreadsheets.values.get({
					spreadsheetId: '1AbFd4B3008AEpfAoASFTUp3oUq2sw3rs4IoeoR8-X5c',
					range: 'Blad1',
				});
			}).then(function(response) {
					const values = response.result.values
					const guilds = {
						horde: [],
						alliance: []
					};
					const startingRow = 6;
					const $hordeGuilds = $('#horde-guilds');
					const $allianceGuilds = $('#alliance-guilds');
					const players = {
						'horde': 0,
						'alliance': 0
					};

					for (let i = 0; i < values.length; i += 1) {
						if (i >= startingRow && values[i].length) {
							if (!values[i].includes('Horde players:')) {
								const hordeGuild = {
									nation: values[i][2],
									name: values[i][3],
									discord: values[i][4],
									discordSimple: values[i][4].replace('https://', '').replace('http://', ''),
									leader: values[i][5],
									players: values[i][6],
								}

								hordeGuild.template = buildTemplate(hordeGuild);
								guilds.horde.push(hordeGuild);

								if (values[i][12]) {
									const allianceGuild = {
										nation: values[i][8],
										name: values[i][9],
										discord: values[i][10],
										discordSimple: values[i][10].replace('https://', '').replace('http://', ''),
										leader: values[i][11],
										players: values[i][12],
									}

									allianceGuild.template = buildTemplate(allianceGuild);
									guilds.alliance.push(allianceGuild);
								}
							}
						}
					}

					for (let i = 0; i < guilds.horde.length; i += 1) {
						$hordeGuilds.append(guilds.horde[i].template);

						if (!isNaN(guilds.horde[i].players)) {
							players.horde += parseInt(guilds.horde[i].players);
						}
					}

					for (let i = 0; i < guilds.alliance.length; i += 1) {
						$allianceGuilds.append(guilds.alliance[i].template);

						if (!isNaN(guilds.alliance[i].players)) {
							players.alliance += parseInt(guilds.alliance[i].players);
						}
					}

					loadPlayersChart(players);
			}, function(reason) {
				console.log('Error: ' + reason.result.error.message);
			});
		};

		function buildTemplate(guild) {
			let string = '<div class="col-12 guild">';

			if (guild.name) {
				string += '<div class="name">' + guild.name + '</div>';
			} else {
				return '';
			}

			if (guild.nation) {
				string += '<div class="nation">' + guild.nation + '</div>';
			}

			if (guild.discord) {
				string += '<div class="discord">';

				if (guild.discord.search('https://') != -1 || guild.discord.search('http://') != -1) {
					string += '<a target="_blank" href="' + guild.discord + '">' + guild.discordSimple + '</a>';
				} else {
					string += guild.discord;
				}

				string += '</div>';
			}

			string += '</div>';

			return string;
		}

		$(document).ready(function() {
			gapi.load('client', start);
		});
		</script>
	</body>
</html>