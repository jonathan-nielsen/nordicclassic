<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Welcome to Nordic Classic!</title>
		<link rel="stylesheet" href="./css/viewport.css">
	</head>
	<body>
		<div class="hero">
			<div class="bg"></div>
			<div class="title welcome">Welcome to the Nordic Gehennas Community</div>
		</div>
		<div class="container news">
			<div class="title d-inline-block">News</div>
			<div class="updates py-3 py-md-5">
				<div class="update">
					<time datetime="2019-08-14 - 18:13">2019-08-14 - 18:13</time>
					<p>Nu har den nordiska koalitionen valt att byta server till den nya EU PVP servern.
						<br>Tyvärr så väljer några norska gillen att stanna kvar. Men majoriteten av alla väljer att följa med.
						<br>Vi önskar våra norska vänner som stannar lycka till!
						<br>Till alla er andra: Sprid ordet nu direkt. Så att så många av oss som möjligt får vara med och välja de namn vi önskar!
						<br>Hjälp era gillen och vänner. Tillsammans kommer vi göra detta till WOW-världens bästa Nordic-server!!!
						<br>Men detta kan vi bara göra tillsammans så vi behöver alla !! Så hjälp oss nu.
						<br>(PS: Alla i SCRUBCLUB måste vara på KOS-listan hos alla av alliansens kämpar //BIZZNO)</p>
				</div>
				<div class="update">
					<time datetime="2019-08-11 - 21:04">2019-08-11 - 21:04</time>
					<p>Vi har valt server! Hoppas nu att alla är nöjda med vårt val och att vi alla kommer ha riktigt kul på denna servern.</p>
				</div>
				<div class="update">
					<time datetime="2019-08-10 - 20:06">2019-08-10 - 20:06</time>
					<p>Någon mupp försöker sprida rykten om att vi alla skall spela på RP-PVP. Detta stämmer INTE !
						<br>Vi kommer välja någon av de två EU PVP servrarna.</p>
				</div>
				<div class="update">
					<time datetime="2019-08-09 - 22:33">2019-08-09 - 22:33</time>
					<p>Vi kommer att gå ut med vilken server vi väljer på Söndag 2019-08-11</p>
				</div>
				<div class="update">
					<time datetime="2019-08-09 - 19:44">2019-08-09 - 19:44</time>
					<p>Diskussion pågår just nu om vilken server som kommer väljas.</p>
				</div>
			</div>
		</div>
		<div class="container mt-4 py-3 py-md-5">
			<div class="row">
				<h3 class="col-9 col-md-12 py-3 py-md-0 pl-0 pl-md-3 text-md-center mb-4 mb-md-0 supporting order-1">
					The following WoW Classic guilds
					<br>has chosen to support this initiative.
				</h3>
				<div class="col-3 col-md-12 text-md-center order-0 order-md-1 px-0 px-md-3 horde-alliance mb-5 mb-md-0">
					<img src="./img/horde-alliance.png" alt="">
				</div>
				<div class="col-12 col-md-6 order-2">
					<div class="title mb-5">Horde</div>
					<div class="row" id="horde-guilds"></div>
				</div>
				<div class="col-12 col-md-6 text-md-right order-3 mt-5 mt-md-0">
					<div class="text-md-right md-right title mb-5">Alliance</div>
					<div class="row" id="alliance-guilds"></div>
				</div>
			</div>
		</div>
		<div class="join-us mt-5 py-4 py-md-5">
			<div class="container">
				<div class="row">
					<div class="title">Join us</div>
					<p class="col-12">Do your guild wish to become a part of Nordic Classic?
						<br>Please contact the Guild Masters of either <b>BIZZNO</b> or <b>SCRUBCLUB</b>.
						<br>You'll find a link to their Discord server amongst the listed guilds.</p>
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="copyright col-12 text-center py-4 py-md-5">
					Copyright ® 2019 Nordic Classic
					<br>Design by the Nordic Classic Community
				</div>
			</div>
		</div>
		<link rel="stylesheet" href="./css/bootstrap/bootstrap.min.css">
		<link rel="stylesheet" href="./css/style.css">
		<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
		<script src="https://apis.google.com/js/api.js"></script>
		<script>
		function start() {
			gapi.client.init({
				'apiKey': 'AIzaSyCLd8pNZypoOYdG2rHcKuYKgHveQlxj9TE',
				'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
			}).then(function() {
				return gapi.client.sheets.spreadsheets.values.get({
					spreadsheetId: '1AbFd4B3008AEpfAoASFTUp3oUq2sw3rs4IoeoR8-X5c',
					range: 'Blad1',
				});
			}).then(function(response) {
					const values = response.result.values
					const guilds = {
						horde: [],
						alliance: []
					};

					for (let i = 0; i < values.length; i += 1) {
						if (i >= 4 && values[i].length) {
							if (!values[i].includes('Horde players:')) {
								const hordeGuild = {
									nation: values[i][2],
									name: values[i][3],
									discord: values[i][4],
									discordSimple: values[i][4].replace('https://', ''),
									leader: values[i][5],
									players: values[i][6],
								}

								hordeGuild.template = buildTemplate(hordeGuild);
								guilds.horde.push(hordeGuild);

								if (values[i][12]) {
									const allianceGuild = {
										nation: values[i][8],
										name: values[i][9],
										discord: values[i][10],
										discordSimple: values[i][10].replace('https://', ''),
										leader: values[i][11],
										players: values[i][12],
									}

									allianceGuild.template = buildTemplate(allianceGuild);
									guilds.alliance.push(allianceGuild);
								}
							}
						}
					}

					console.log(guilds);

					const $hordeGuilds = $('#horde-guilds');
					const $allianceGuilds = $('#alliance-guilds');

					for (let i = 0; i < guilds.horde.length; i += 1) {
						$hordeGuilds.append(guilds.horde[i].template);
					}

					for (let i = 0; i < guilds.alliance.length; i += 1) {
						$allianceGuilds.append(guilds.alliance[i].template);
					}
			}, function(reason) {
				console.log('Error: ' + reason.result.error.message);
			});
		};

		function buildTemplate(guild) {
			let string = '<div class="col-12 guild">';

			if (guild.name) {
				string += '<div class="name">' + guild.name + '</div>';
			} else {
				return '';
			}

			if (guild.nation) {
				string += '<div class="nation">' + guild.nation + '</div>';
			}

			if (guild.discord) {
				string += '<div class="discord">';

				if (guild.discord.search('https://') != -1) {
					string += '<a target="_blank" href="' + guild.discord + '">' + guild.discordSimple + '</a>';
				} else {
					string += guild.discord;
				}

				string += '</div>';
			}

			string += '</div>';

			return string;
		}

		$(document).ready(function() {
			gapi.load('client', start);
		});
		</script>
	</body>
</html>